<div #sectionContainer *ngIf="editable || (containsBlocks && !hideForCurrentScreenType)" class="section-container " 
    [ngClass]="{ 'editable-state': editable, 'active-section': selected, 'section-hidden-state': hideForCurrentScreenType }" 
    cdkDrag [cdkDragDisabled]="!editable" (cdkDragStarted)="onDragStart($event)" (cdkDragEnded)="onDragEnd($event)" >
    <toolbar-actions *ngIf="editable && canDrag" cdkDragHandle style="cursor: grab;"
        class="section-toolbar" [title]="name" [isDraggable]="true"
        (editClick)="onEditSectionClick();" (removeClick)="onRemoveSectionClick()"
        [hideIn]="hideIn" (hideInChange)="onHideSectionChange($event)"></toolbar-actions>
    <div *ngIf="editable" class="section-background">
        <div class="back-template" *ngFor="let number of [0,1,2,3,4,5,6,7,8,9,10,11]"></div>
    </div>
    <div #columnsWrapper class="columns-wrapper gap-{{ columnsGap }}">
        <div [id]="sectionColumnKeyPrefix + i" 
            *ngFor="let column of columns; let i=index;"
            class="section-column {{screenSize <= pepScreenSizeToFlipToVertical ? 'horizontal' : 'vertical'}}"
            [ngClass]="{ 'active-column': selectedBlockId === column.Block?.BlockKey }"
            cdkDropList
            [cdkDropListData]="column"
            [cdkDropListOrientation]="screenSize <= pepScreenSizeToFlipToVertical ? 'horizontal' : 'vertical'" 
            [cdkDropListConnectedTo]="sectionsColumnsDropList"
            (cdkDropListDropped)="onBlockDropped($event)"
            [cdkDropListEnterPredicate]="canDropPredicate(i)"
        >
            <div *ngIf="column.Block && pageBlocksMap.has(column.Block.BlockKey) && (editable || !hideColumnsForCurrentScreenTypeMap.has(column.Block.BlockKey))" 
                class="section-column-block"
                [ngClass]="{ 'block-hidden-state': hideColumnsForCurrentScreenTypeMap.has(column.Block.BlockKey) }"
                cdkDrag [cdkDragData]="column.Block" [cdkDragDisabled]="!editable || !canDrag" (cdkDragStarted)="onDragStart($event)" (cdkDragEnded)="onDragEnd($event)" 
            >
                <toolbar-actions *ngIf="editable && canDrag" cdkDragHandle style="cursor: grab;"
                    class="block-toolbar" [title]="pageBlocksMap.get(column.Block.BlockKey).Relation?.Description" [isDraggable]="true"
                    (editClick)="onEditBlockClick(column.Block.BlockKey);" (removeClick)="onRemoveBlockClick(column.Block.BlockKey)"
                    [hideIn]="column.Block.Hide" (hideInChange)="onHideBlockChange(column.Block.BlockKey, $event)">
                </toolbar-actions>
                <div [ngClass]="{'block-editable-state': editable }">
                    <pep-remote-loader 
                        [options]="pageBlocksMap.get(column.Block.BlockKey).Relation?.Options"
                        [hostObject]="pageBlocksMap.get(column.Block.BlockKey).Configuration"
                        (hostEvents)="onBlockChange($event, column.Block.BlockKey);">
                    </pep-remote-loader>
                </div>
            </div>
        </div>
    </div>
</div>
