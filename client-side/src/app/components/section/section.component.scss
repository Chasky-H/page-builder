@import 'ngx-lib/src/core/style/abstracts/variables';
@import 'ngx-lib/src/core/style/abstracts/mixins';
@import '../../../mixins.scss';

$z-index-toolbar: $z-index-min + 2;

@mixin block-toolbar() {
    @include block-editor-toolbar();
    z-index: $z-index-toolbar;
}

.section-container {
    position: relative;
    display: grid;
    border-radius: $border-radius-md;
    min-height: 250px;
    
    // // Mobile size
    // @media (max-width: $screen-max-size-xs) {
    //     &:not(&.editable-state) {
    //         &.hidden-state {
    //             display: none;
    //         }
    //     }
    // }

    // // Tablet size
    // @media (max-width: $screen-max-size-sm) {
    //     &:not(&.editable-state) {
    //         &.hidden-state {
    //             display: none;
    //         }
    //     }
    // }

    // // Desktop size
    // @media (min-width: $screen-max-size-sm) {
    //     &:not(&.editable-state) {
    //         &.hidden-state {
    //             display: none;
    //         }
    //     }
    // }

    // This css is run also without edit mode!!!.
    .columns-wrapper {
        display: grid;
        grid-auto-flow: column;

        @include gap-sizes();
        
        .section-column {
            overflow: hidden;

            // In vertical (small screens) we remove the section column if it's empty.
            &.remove-vertical-empty-column {
                display: none;
            }
        }
    }
    
    // This css is only for edit mode!!!.
    &.editable-state {
        &.active-section {
            z-index: $z-index-min + 11;
        }

        .section-toolbar {
            position: absolute;
            width: 100%;
            z-index: $z-index-toolbar;
        }

        .section-background {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: $z-index-min;
            display: grid;
            grid-template-columns: repeat(12, 1fr);

            .back-template {
                opacity: 0.1;

                &:last-of-type {
                    border-right: 0 none;
                }
            }
        }

        .columns-wrapper {
            .section-column {
                z-index: $z-index-min + 1;
                position: relative;

                &.active-column {
                    z-index: $z-index-min + 12;
                    position: relative;
                    
                    .block-editable-state {
                        opacity: 1;
                    }
                }

                .section-column-block {
                    .block-editable-state {
                        pointer-events: none;
                        opacity: 0.5;
                    }
                    
                    .block-toolbar {
                        @include block-toolbar();
                    }
                }
            }
        }
    }
}

.cdk-drag-preview {
    .block-editable-state {
        opacity: 0;
    }

    .block-toolbar {
        @include block-toolbar();
    }
}

// The placeholder of the sections and the blocks in the section.
.cdk-drag-placeholder {
    &.section-container {
        opacity: 0.5;
    }

    .block-toolbar {
        opacity: 0;
    }
}